<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.kosta.watflix.model.mapper.QnAMapper">
<!--  QnA 작성  -->
<insert id="mQnAWrite" parameterType="qnaVO">
	<selectKey keyProperty="qnaNo" resultType="int" order="BEFORE"> 
		select qna_seq.nextval from dual
	</selectKey>
	insert into qna(QNA_NO,ID,QNA_TITLE,QNA_CONTENTS)
	values(#{qnaNo},#{memberVO.id},#{qnaTitle},#{qnaContents})
</insert>
<!-- QNA 상세보기-->
<select id="mQnADetail" resultType="qnaVO">
	select QNA_NO, QNA_TITLE,to_char(QNA_POSTED_TIME,'YYYY.MM.DD HH24:MI:SS')
	as QNA_POSTED_TIME,ID,QNA_CONTENTS
	from qna
	where QNA_NO=#{qnaNo}
</select>
<!-- QNA 삭제 -->
<delete id="mQnADelete" parameterType="faqVO">
	delete from qna where QNA_NO=#{qnaNo}
</delete>
<!-- QNA 갯수 가져오기 -->
<select id="mGetTotalQnACount" resultType="int">
	select COUNT(*) from QNA
</select>
<!-- QNA 리스트 가져오기 -->
<select id="mGetQnAList" resultMap="qnaRM" parameterType="pagingBean">
	select QNA_NO,ID,QNA_TITLE,QNA_CONTENTS,QNA_POSTED_TIME
	from (select ROW_NUMBER() OVER(ORDER BY QNA_NO DESC) AS RNUM, ID, QNA_NO,QNA_TITLE,QNA_CONTENTS,QNA_POSTED_TIME FROM QNA)
</select>
 	<!-- QnAVO에 MemberVO의 id(has a 관계)를 넣을 수 있도록 ResaultMap을 셋팅한다. -->
	<resultMap type="qnaVO" id="qnaRM">
		<result property="memberVO.id" column="id" />
	</resultMap>
 </mapper>
 
 
 
 
 
 
 
 
 
 